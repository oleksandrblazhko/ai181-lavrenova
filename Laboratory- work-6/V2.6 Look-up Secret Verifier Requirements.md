# V2.6 Look-up Secret Verifier
Секрети пошуку — це заздалегідь згенеровані списки секретних кодів, подібні до номерів авторизації транзакцій (TAN), кодів відновлення соціальних медіа або сітки, що містять набір випадкових величин. Вони розповсюджуються безпечно для користувачів. Ці коди пошуку використовуються один раз, і після того, як всі використовуються, список пошуку буде відкинуто. Цей тип автентифікації вважається «чимось, що у вас є».
| #     | Description                                                                                                                                                                                                                  | L1 | L2 | L3 | CWE | NIST§   |
|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----|----|----|-----|---------|
| 2.6.1 | Переконайтеся, що секрети пошуку можна використовувати лише один раз.                                                                                                                                                        |    | ✓  | ✓  | 308 | 5.1.2.2 |
| 2.6.2 | Переконайтеся, що секрети пошуку мають достатню випадковість (112 біт ентропії), або, якщо менше 112 біт ентропії, додані унікальною випадковою 32-бітною сіллю та хешовані за допомогою затвердженого одностороннього хешу. |    | ✓  | ✓  | 330 | 5.1.2.2 |
| 2.6.3 | Переконайтеся, що секрети пошуку стійкі до атак в автономному режимі, наприклад передбачувані значення.                                                                                                                      |    | ✓  | ✓  | 310 | 5.1.2.2 |

## CWE:
* ### CWE-308: Use of Single-factor Authentication
  #### Опис </br>
  Використання однофакторної автентифікації може призвести до непотрібного ризику компромісу порівняно з перевагами схеми двофакторної автентифікації.
  #### Розширений опис </br>
  Хоча використання кількох схем автентифікації просто ускладнює автентифікацію, мати такі заходи надлишковості є неймовірно цінним. В Інтернеті широко поширене використання слабких, повторно використовуваних і поширених паролів. Без додаткового захисту кількох схем автентифікації одна помилка може призвести до компрометації облікового запису. З цієї причини, якщо кілька схем можливі та також прості у використанні, їх слід впроваджувати та вимагати.
  #### Застосовні платформи </br>
  ##### Мови
  Клас: не залежить від мови (поширеність не визначена)
  #### Загальні наслідки </br>
  | Межі             | Вплив                                                                                           |
  |------------------|-------------------------------------------------------------------------------------------------|
  | Контроль доступу | Технічний вплив: механізм захисту від байпасу                                                   |
  |                  | Якщо секрет у схемі однофакторної автентифікації скомпрометовано, можлива повна автентифікація. |
  #### Ймовірність експлойту </br>
  Висока
* ### CWE-330: Use of Insufficiently Random Values
  #### Опис </br>
  Програмне забезпечення використовує недостатньо випадкових чисел або значень у контексті безпеки, який залежить від непередбачуваних чисел.
  #### Розширений опис </br>
  Коли програмне забезпечення генерує передбачувані значення в контексті, що вимагає непередбачуваності, зловмисник може вгадати наступне значення, яке буде згенеровано, і використати це припущення, щоб видати себе за іншого користувача або отримати доступ до конфіденційної інформації.
  #### Застосовні платформи </br>
  ##### Мови
  Клас: не залежить від мови (поширеність не визначена)
  ##### Технології
  Клас: не залежить від технології (поширеність не визначена)
  #### Загальні наслідки </br>
  | Межі                   | Вплив                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
  |------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
  | Конфіденційність  Інше | Технічний вплив: інше                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
  |                        | Коли механізм захисту покладається на випадкові значення для обмеження доступу до конфіденційного ресурсу, такого як ідентифікатор сеансу або початкове число для генерації криптографічного ключа, тоді доступ до захищеного ресурсу можна отримати, вгадавши ідентифікатор або ключ.                                                                                                                                                                                                                                                                                                                                                                                                                                |
  |                        | Технічний вплив: захисний механізм обходу; Інший                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
  | Контроль доступу  Інше | Якщо програмне забезпечення для ідентифікації ресурсу покладається на унікальні ідентифікатори, які неможливо вгадати, зловмисник може вгадати ідентифікатор ресурсу, який належить іншому користувачеві. Тоді зловмисник може прочитати ресурс або попередньо створити ресурс із таким самим ідентифікатором, щоб завадити законній програмі належним чином надіслати ресурс призначеному користувачеві. Наприклад, продукт може зберігати інформацію про сеанс у файлі, ім’я якого базується на імені користувача. Зловмисник може попередньо створити цей файл для користувача-жертви, а потім встановити дозволи так, щоб програма не могла створити сеанс для жертви, заважаючи жертві використовувати програму. |
  |                        | Технічний вплив: захисний механізм обходу; Отримайте привілеї або присвойте собі ідентифікацію                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
  | Контроль доступу       | Коли механізм авторизації або автентифікації покладається на випадкові значення для обмеження доступу до обмежених функцій, таких як ідентифікатор сеансу або початкове число для генерації криптографічного ключа, тоді зловмисник може отримати доступ до обмежених функцій, вгадавши ідентифікатор або ключ.                                                                                                                                                                                                                                                                                                                                                                                                       |
  #### Ймовірність експлойту </br>
  Висока
* ### CWE CATEGORY: Cryptographic Issues
  Слабкі сторони цієї категорії пов’язані з розробкою та впровадженням конфіденційності та цілісності даних. Часто вони мають справу з використанням методів кодування, бібліотек шифрування та алгоритмів хешування. Слабкі місця в цій категорії можуть призвести до погіршення якості даних, якщо їх не усунути.
  </br> Використання для зіставлення: заборонено (цей ідентифікатор CWE не можна використовувати для зіставлення з реальними вразливими місцями).
